<div class="row">
    <div class="col-md-12">
        <div class="card">
            <div class="card-header card-header-primary card-header-icon">
                <div class="card-icon">
                    <i class="material-icons">assignment</i>
                </div>
                <h4 class="card-title">文章列表</h4>
                <a class="btn btn-success float-right btn-sm" href="/cms/create"><i class="fa fa-plus-circle"></i> 添加权限 </a>
            </div>
            <div class="card-body">
                <div class="toolbar">
                    <!--        Here you can write extra buttons/actions for the toolbar              -->
                </div>
                <div class="material-datatables">
                    <table id="datatable" class="table table-striped table-no-bordered table-hover" cellspacing="0"
                           style="width:100%">
                        <thead>
                        <tr>
                            <th width="70">ID</th>
                            <th>名称</th>
                            <th>UUID</th>
                            <th width="150">创建时间</th>
                            <th width="150">更新时间</th>
                            <th width="100">操作</th>
                        </tr>
                        </thead>
                        <tbody>
                        </tbody>
                    </table>
                </div>
            </div>
            <!-- end content-->
        </div>
        <!--  end card  -->
    </div>
    <!-- end col-md-12 -->
</div>

<script>
    window.onload = function () {
        $('#datatable').DataTable({
            order: [[1, "desc"]],
            "pagingType": "full_numbers",
            "lengthMenu": [
                [10, 25, 50, -1],
                [10, 25, 50, "All"]
            ],
            "processing": true,
            "serverSide": true,
            language: {
                "sProcessing": "处理中...",
                "sLengthMenu": "显示 _MENU_ 项结果",
                "sZeroRecords": "没有匹配结果",
                "sInfo": "显示第 _START_ 至 _END_ 项结果，共 _TOTAL_ 项",
                "sInfoEmpty": "显示第 0 至 0 项结果，共 0 项",
                "sInfoFiltered": "(由 _MAX_ 项结果过滤)",
                "sInfoPostFix": "",
                "sSearch": "搜索:",
                "sUrl": "",
                "sEmptyTable": "表中数据为空",
                "sLoadingRecords": "载入中...",
                "sInfoThousands": ",",
                "oPaginate": {
                    "sFirst": "首页",
                    "sPrevious": "上页",
                    "sNext": "下页",
                    "sLast": "末页"
                },
                "oAria": {
                    "sSortAscending": ": 以升序排列此列",
                    "sSortDescending": ": 以降序排列此列"
                }
            },
            "ajax": {
                "url": "/page",
                "type": "POST",
                error: function (arg1) {
                    md.notification(arg1.statusText, 'rose');
                }

            },
            //dom: 'Bfrtip',
            buttons: [
                'csv', 'excel', 'pdf', 'print'
            ],
            sort:false,
            "columns": [
                {"data": "id", "sClass": "text-center"},
                {"data": "title"},
                {"data": "uuid", "sClass": "text-center"},
                {"data": "created_at", "sClass": "hidden-xs text-center"},
                {"data": "updated_at", "sClass": "hidden-xs text-center"},
                {"data": "action", "sClass": "text-center"}
            ],
            columnDefs: [
                {
                    'targets': -1, "render": function (data, type, row) {
                        var row_edit = true;
                        var row_del = true;
                        var str = '';

                        //编辑
                        if (row_edit) {
                            str += '<a class="X-Small btn-xs text-success " href="/cms/' + row['uuid'] + '" ><i class="material-icons">edit</i></a>';
                        }
                        //删除
                        if (row_del) {
                            str += '<a class="X-Small btn-xs text-rose " data-type="edit" data-title="删除：' + row['name'] + '" data-url="/admin/role/' + row['id'] + '" data-toggle="modal" data-target="#modalDel" ><i class="material-icons">close</i></a>';
                        }

                        return str;

                    }
                }
            ]
        });

        var table = $('#datatable').DataTable();
        // Edit record
        table.on('click', '.edit', function () {
            $tr = $(this).closest('tr');
            var data = table.row($tr).data();
            alert('You press on Row: ' + data[0] + ' ' + data[1] + ' ' + data[2] + '\'s row.');
        });

        // Delete a record
        table.on('click', '.remove', function (e) {
            $tr = $(this).closest('tr');
            table.row($tr).remove().draw();
            e.preventDefault();
        });
    };
</script>